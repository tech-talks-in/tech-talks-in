"use strict";(self.webpackChunktech_talks_in=self.webpackChunktech_talks_in||[]).push([[5945],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>u});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),m=p(n),k=r,u=m["".concat(s,".").concat(k)]||m[k]||d[k]||o;return n?a.createElement(u,i(i({ref:t},l),{},{components:n})):a.createElement(u,i({ref:t},l))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=k;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[m]="string"==typeof e?e:r,i[1]=c;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},9077:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>c,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={slug:"docker-basics-102",title:"Docker Basics 102",authors:{name:"Pavan Kumar",title:"tech-talks Core Team",url:"https://github.com/mrpavan",image_url:"https://github.com/mrpavan.png"},tags:["Docker"],sidebar_position:2},i="Docker Basics 102",c={unversionedId:"docker/docker-basics-102",id:"docker/docker-basics-102",title:"Docker Basics 102",description:"Useful docker comamnds for anyones quick reference",source:"@site/docs/docker/docker-basics-102.md",sourceDirName:"docker",slug:"/docker/docker-basics-102",permalink:"/docs/docker/docker-basics-102",draft:!1,tags:[{label:"Docker",permalink:"/docs/tags/docker"}],version:"current",sidebarPosition:2,frontMatter:{slug:"docker-basics-102",title:"Docker Basics 102",authors:{name:"Pavan Kumar",title:"tech-talks Core Team",url:"https://github.com/mrpavan",image_url:"https://github.com/mrpavan.png"},tags:["Docker"],sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Docker Basics 101",permalink:"/docs/docker/docker-basics"},next:{title:"Node js",permalink:"/docs/category/node-js"}},s={},p=[],l={toc:p};function m(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"docker-basics-102"},"Docker Basics 102"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Useful docker comamnds for anyones quick reference")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Check active running containers"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker ps\n")),(0,r.kt)("p",{parentName:"li"},"There might be some coantiners not showing here as they might be in exited state to check all containers simply add -a flag to the docker ps command"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker ps -a\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Check size of docker container"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker container ls --size\n\n")),(0,r.kt)("p",{parentName:"li"},"This will print list of all continers with thier size, quite helpful if you want to keep tab on disk space"),(0,r.kt)("admonition",{parentName:"li",title:"above comamnd doesnt show how much is taken up by logs as they can fill your disc space quite fast and cause issues in running your servcies smoothly. Use below to know about log size",type:"tip"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo du -h $(docker inspect --format='{{.LogPath}}' $(docker ps -qa))\n")),(0,r.kt)("p",{parentName:"admonition"},"Output"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre"},"429M    /var/lib/docker/containers/b9a590c31b48b1/be21d62b9a590c31b4d5138bbfd21ad8e70aa5fb1754b9626ffe702bc99508b1-json.log\n435M    /var/lib/docker/containers/a070d184ba25106ffb78b356865ecc94e8d5c067/a070d184ba251fd04dd228a356865ecc94e8d5c067-json.log\n")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Docker logs - check stdout stream and troubleshoot"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker logs [OPTIONS] container_name_or_id\n\nexample:\ndocker logs -f --until=2s mycontainer_name\n")),(0,r.kt)("p",{parentName:"li"},"Some of the useful options include\n",(0,r.kt)("inlineCode",{parentName:"p"},"--since 5m"),"  provides you logs since last 5m, change to required duration 10m, 50m, 10m50s, 5h\n",(0,r.kt)("inlineCode",{parentName:"p"},"--untill 10m"),"  Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)\n",(0,r.kt)("inlineCode",{parentName:"p"},"--follow , -f")," follow logs, new logs will be displayed as they are generated")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Backup and move your containers"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker save --output file-name.tar container-name\n\nexample:\ndocker save --output mycontainer.tar mycontainer\n")),(0,r.kt)("p",{parentName:"li"},"if you want to use STDOUT > is used instead od --output flag\nThis can be copied to a target machine and iamge can be restored into the new machine with load command as below\nRead from tar archive file, instead of STDIN, for STDIN replace -i or --input with <"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker load -i mycontainer.tar\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Docker filter - matches containers by status. You can filter using ",(0,r.kt)("inlineCode",{parentName:"p"},"created"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"restarting"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"running"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"removing"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"paused"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"exited")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"dead"),". For example, to filter for running containers:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker ps --filter status=running\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"For lsiting only container id, status and names"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'docker ps --format "{{.ID}}: {{.Status}} {{.Names}}"\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Attach and detach to a container"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"# Run the container\ndocker run -d --name mycontainer ubuntu:21.04 /usr/bin/top -b\n\n#Attach to a running container\ndocker attach mycontainer\n\n#detach\nAs the container was started without the -i, and -t options, signals are forwarded to the attached process, which means that the default CTRL-p CTRL-q detach key sequence produces no effect, but pressing CTRL-c terminates the container:\n\n#Check contianer still running not exited\ndocker ps -a --filter name=mycontainer\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Docker Exec - Runs a new command in running container"),(0,r.kt)("p",{parentName:"li"},"This starts shell in mycontainer"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker exec -it mycontainer sh\n")),(0,r.kt)("p",{parentName:"li"},"This creates file in the container"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker exec -d mycontainer touch /tmp/test-file.txt\n")),(0,r.kt)("p",{parentName:"li"},"By default, the docker exec command, inherits the environment variables that are set at the time the container is created. Use the --env (or the -e shorthand) to override global environment variables, or to set additional environment variables for the process started by docker exec."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"docker exec -e VAR_A=1 -e VAR_B=2 mycontainer env\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Time and again you might need to configure docker to your preferences. for examole logging, if you want to limit the log file to 10Mb and keep utmost 3 files, perform auto rotation or use different network for your containers as default might be conflicting with your exisitng services. Go ahead and create a new file daemon.json in ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/docker/daemon.json")," and add below lines"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},'{\n"log-driver": "local | json-file",\n"log-opts": {\n    "max-size": "10m",\n    "max-file": "3",\n    }\n"live-restore": true,\n"bip": "10.10.10.1/24",\n"default-address-pools": [{\n    "base": "10.10.10.0/24",\n    "size": 100\n}],\n"dns": ["8.8.8.8"],\n"dns-search": ["home.local"]\n}\n\n')),(0,r.kt)("admonition",{parentName:"li",title:"need to restart containers",type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"restart docker service ",(0,r.kt)("inlineCode",{parentName:"p"},"service docker restart")),(0,r.kt)("p",{parentName:"admonition"},"stop, remove containers and start again ")),(0,r.kt)("p",{parentName:"li"},"More to come ...."))))}m.isMDXComponent=!0}}]);